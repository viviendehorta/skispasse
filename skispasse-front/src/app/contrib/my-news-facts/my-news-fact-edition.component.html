<div class="my-news-fact-edition card">

  <div class="card-header">
    <h2>
      <span>New Publication</span>
    </h2>
    <div class="btn-group float-right">
      <button class="btn btn-primary" type="submit" routerLink="/">
        <fa-icon [icon]="'arrow-left'"></fa-icon>&nbsp;<span>Back to map</span>
      </button>
    </div>
  </div>

  <div class="card-body">

    <form class="form" name="editForm" role="form" novalidate (ngSubmit)="publish()" [formGroup]="editionForm">

      <skis-alert-error></skis-alert-error>

      <!-- Id (hidden and not null when updating existing news fact) -->
      <div class="form-group" [hidden]="!newsFact.id">
        <label>Id</label>
        <input type="text" class="form-control" readonly
               name="id"
               formControlName="id">
      </div>

      <!-- News category -->
      <div class="form-group">
        <label for="newsCategorySelect">News category</label>
        <select class="form-control" id="newsCategorySelect"
                name="newsCategoryId"
                formControlName="newsCategoryId">
          <option *ngFor="let newsCategory of this.newsCategories" ngValue="{{newsCategory.id}}">
            {{newsCategory.label}}
          </option>
        </select>

        <div *ngIf="editionForm.get('newsCategoryId').invalid && (editionForm.get('newsCategoryId').touched)">
          <small class="form-text text-danger"
                 *ngIf="editionForm.get('newsCategoryId').errors.required">
            This field is required.
          </small>
        </div>
      </div>

      <!-- Event date -->
      <div class="input-group">
        <input class="form-control"
               placeholder="Event date (yyyy-mm-dd)"
               ngbDatepicker
               #d="ngbDatepicker"
               name="eventDate"
               formControlName="eventDate">
        <div class="input-group-append">
          <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button" title="Select in calendar">
            <fa-icon [icon]="'calendar-alt'"></fa-icon>
          </button>
        </div>
      </div>

      <div class="form-row">

        <!-- Address -->
        <div class="form-group col-md-6">
          <label for="addressInput">Address</label>
          <input type="text" class="form-control" id="addressInput"
                 placeholder="Enter address"
                 name="address"
                 formControlName="address">

          <div
            *ngIf="editionForm.get('address').invalid && (editionForm.get('address').dirty || editionForm.get('address').touched)">
            <small class="form-text text-danger"
                   *ngIf="editionForm.get('address').errors.required">
              This field is required.
            </small>
          </div>
        </div>

        <!-- City -->
        <div class="form-group col-md-3">
          <label for="cityInput">City</label>
          <input type="text" class="form-control" id="cityInput"
                 placeholder="Enter city"
                 name="city"
                 formControlName="city">

          <div
            *ngIf="editionForm.get('city').invalid && (editionForm.get('city').dirty || editionForm.get('city').touched)">
            <small class="form-text text-danger"
                   *ngIf="editionForm.get('city').errors.required">
              This field is required.
            </small>
          </div>
        </div>

        <!-- Country -->
        <div class="form-group col-md-3">
          <label for="countryInput">Country</label>
          <input type="text" class="form-control" id="countryInput"
                 placeholder="Enter country"
                 name="country"
                 formControlName="country">

          <div
            *ngIf="editionForm.get('country').invalid && (editionForm.get('country').dirty || editionForm.get('country').touched)">
            <small class="form-text text-danger"
                   *ngIf="editionForm.get('country').errors.required">
              This field is required.
            </small>
          </div>
        </div>
      </div>

      <div class="form-row">

        <!-- Location Coordinate X -->
        <div class="form-group col-md-6">
          <label for="locationCoordinateXInput">Location coordinate X</label>
          <input type="number" class="form-control" id="locationCoordinateXInput"
                 placeholder="Enter location coordinate X"
                 name="locationCoordinateX"
                 formControlName="locationCoordinateX">

          <div
            *ngIf="editionForm.get('locationCoordinateX').invalid && (editionForm.get('locationCoordinateX').dirty || editionForm.get('locationCoordinateX').touched)">
            <small class="form-text text-danger"
                   *ngIf="editionForm.get('locationCoordinateX').errors.required">
              This field is required.
            </small>
          </div>
        </div>

        <!-- Location Coordinate Y -->
        <div class="form-group col-md-6">
          <label for="locationCoordinateYInput">Location Coordinate Y</label>
          <input type="number" class="form-control" id="locationCoordinateYInput"
                 placeholder="Enter location coordinate Y"
                 name="locationCoordinateY"
                 formControlName="locationCoordinateY">
          <div
            *ngIf="editionForm.get('locationCoordinateY').invalid && (editionForm.get('locationCoordinateY').dirty || editionForm.get('locationCoordinateY').touched)">
            <small class="form-text text-danger"
                   *ngIf="editionForm.get('locationCoordinateY').errors.required">
              This field is required.
            </small>
          </div>
        </div>
      </div>

      <!-- News fact video upload -->
      <div class="form-group">
        <label for="videoFileInput">Video file</label>
        <input type="file" class="form-control-file" id="videoFileInput"
               name="newsFactVideoPath"
               formControlName="newsFactVideoPath">
      </div>

      <div>

        <button type="button" class="btn btn-primary" (click)="previousState()">
          <fa-icon [icon]="'ban'"></fa-icon>&nbsp;<span>Cancel</span>
        </button>

        <button type="submit" [disabled]="editionForm.invalid || isPublishing" class="btn btn-primary">Publish
        </button>
      </div>
    </form>

  </div>
</div>
